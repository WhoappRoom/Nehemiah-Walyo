<!DOCTYPE html>
<html lang="en">
  <head>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" rel="stylesheet">
    <title>Nehemiah Walyo | Personal Page home</title>
    <link rel="icon" href="me.jpg">
    <style>
      body {
        margin: 0;
        background-color: lightgreen;
        padding: 0;
        color: blue;
        font-family: Arial, sans-serif;
      }
      #header {
        position: fixed;
        top: 0;
        left: 0;
        display: flex;
        justify-content: flex-end;
        align-items: center;
        right: 0;
        height: 45px;
        background-color: #333;
        z-index: 1000;
      }
      button {
        padding: 10px;
        color: #fff;
        border: none;
        cursor: pointer;
        background-color: #333;
      }
      #menu {
        margin-right: 20px;
        color: #fff;
        font-size: 20px;
        background-color: #333;
        border-radius: 50%;
        width: 40px;
        height: 40px;
      }
      #drop {
        position: relative;
        z-index: 1000;
      }
      #down {
        position: absolute;
        right: 0;
        top: 45px;
        overflow: hidden;
        width: 0;
        display: flex;
        color: #fff;
        transition: 1s;
        padding: 0;
        height: 100vh;
        border-radius: 5px;
        flex-direction: column;
        background-color: #333;
        z-index: 999;
      }
      a {
        text-decoration: none;
        color: #fff;
        background-color: #333;
        padding: 10px;
        margin-top: 20px;
        border-radius: 4px;
      }
      #drop:hover > #down {
        width: 400px;
        padding: 10px;
      }
      #main {
        width: 100%;
        display: flex;
        justify-content: center;
        flex-direction: column;
        padding-top: 60px;
        z-index: 1;
      }
      #posts {
        display: flex;
        flex-direction: column;
        gap: 20px;
        margin: 20px;
      }
      .postDiv {
        box-shadow: 0 0 20px rgba(0,0,0,0.2);
        padding: 10px;
        text-align: left;
        z-index: 1;
        border-radius: 4px;
      }
      .postDiv h1 {
        text-align: left;
        font-size: 24px;
        margin-bottom: 10px;
      }
      .postDiv span {
        text-align: left;
        display: block;
        margin-bottom: 10px;
        font-size: 16px;
        color: #333;
      }
      .postDiv img, .postDiv video {
        text-align: center;
        max-width: 100%;
        object-fit: cover;
        height: auto;
        border-radius: 4px;
        margin-bottom: 10px;
      }
      .postDiv .userImage {
        width: 50px;
        display: flex;
        object-fit: cover;
        height: 50px;
        border-radius: 50%;
        margin-bottom: 10px;
      }
      .postDiv .timestamp {
        text-align: left;
        font-size: 14px;
        color: #666;
        margin-bottom: 10px;
      }
      #about {
        position: fixed;
        left: 0;
        right: 0;
        top: 0;
        display: none;
        justify-content: center;
        align-items: center;
        flex-direction: column;
        bottom: 0;
        color: #000;
        background-color: #f3f3f3;
        z-index: 1001;
      }
      #box {
        padding: 20px;
        width: 350px;
        position: relative;
        box-shadow: 0 0 20px rgba(0,0,0,0.2);
        border-radius: 9px;
        background-color: #fff;
      }
      .btn {
        width: 46%;
        padding: 10px;
        background-color: #333;
        color: #fff;
        border: none;
        border-radius: 4px;
        cursor: pointer;
      }
      .btn:hover {
        background-color: #555;
      }
      #others {
        width: 100%;
        display: flex;
        gap: 20px;
        flex-wrap: wrap;
        margin-top: 20px;
      }
      #close {
        border-radius: 50%;
        height: 40px;
        top: 10px;
        left: 10px;
        position: absolute;
        width: 40px;
        background-color: #333;
        color: #fff;
        border: none;
        cursor: pointer;
      }
      #my {
        width: 200px;
        object-fit: cover;
        height: 200px;
        border-radius: 50%;
      }
      img{
        object-fit: cover;
        }
    </style>
  </head>
  <body>
    <div id="app">
      <header id="header">
        <div id="drop">
          <button id="menu"><i class="fa fa-bars"></i></button>
          <div id="down">
            <a href="/">Home</a>
            <a href="#" id="me">About me</a>
          </div>
        </div>
      </header>
      <main id="main">
        <div id="posts"></div>
      </main>
      <div id="about">
        <div id="box">
          <button id="close"><i class="fa fa-arrow-left"></i></button>
          <img src="me.jpg" id="my">
          <h1>Nehemiah Walyo</h1>
          <hr>
          <h1>About me</h1>
          <p>My name is Nehemiah Walyo. This is my personal website I created.</p>
          <p>Please visit our website as social media web app.</p>
          <div id="others">
            <button class="btn" onclick="location.href='https://small-pencil.website'">Small pencil</button>
            <button class="btn" onclick="location.href='https://audio-waves.vercel.app'">Audio Waves</button>
            <button class="btn" onclick="location.href='https://mycoderseven.site'">My Coder Seven</button>
            <button class="btn" onclick="location.href='https://ninyaaban.site'">Nin Yaaban</button>
          </div>
        </div>
      </div>
      <footer id="footer"></footer>
    </div>
    <script type="module">
      import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.4/firebase-app.js";
      import { getFirestore, collection, onSnapshot, doc, addDoc } from 'https://www.gstatic.com/firebasejs/10.12.4/firebase-firestore.js';
      const firebaseConfig = {
        apiKey: "AIzaSyAqroFBiLs0JiqijGhrXpbgNkMplMmQs70",
        authDomain: "whoapp-840f8.firebaseapp.com",
        projectId: "whoapp-840f8",
        storageBucket: "whoapp-840f8.appspot.com",
        messagingSenderId: "245604477946",
        appId: "1:245604477946:web:bba9a7ea55b5d3a1f25243"
      };
      const app = initializeApp(firebaseConfig);
      const db = getFirestore(app);
      
      let count = 0;
      window.onload = function () {
        count++
        addDoc(collection(db, 'visitors'), {
          count: count
        })
      }
      onSnapshot(collection(db, 'posts'), (querySnapshot) => {
        var posts = document.getElementById('posts');
        posts.innerHTML = '';
        querySnapshot.forEach((doc) => {
          const data = doc.data();

          function createMediaElement(data) {
            if (data.fileType === 'image') {
              var img = document.createElement('img');
              img.src = data.url;
              return img;
            } else if (data.fileType === 'video') {
              var video = document.createElement('video');
              video.src = data.url;
              video.controls = true;
              video.addEventListener('play', function () {
                var allVideos = document.querySelectorAll('video');
                allVideos.forEach(other => {
                  if(other !== video) {
                    other.pause();
                  }
                })
              })
              return video;
            } else {
              var img = document.createElement('img');
              img.src = data.url;
              return img;
            }
          }

          var postDiv = document.createElement('div');
          postDiv.classList.add('postDiv');
          var title = document.createElement('h1');
          title.innerHTML = data.title;

          var description = document.createElement('span');
          description.innerHTML = data.description;

          var media = createMediaElement(data);

          var userImage = document.createElement('img');
          userImage.classList.add('userImage');
          userImage.src = data.userImage;

          var timestamp = document.createElement('span');
          timestamp.classList.add('timestamp');
          timestamp.innerHTML = new Date(data.time.seconds * 1000).toLocaleString();

          var hr = document.createElement('hr');

          postDiv.appendChild(title);
          postDiv.appendChild(document.createElement('br'));
          postDiv.appendChild(description);
          postDiv.appendChild(document.createElement('br'));
          postDiv.appendChild(media);
          postDiv.appendChild(document.createElement('br'));
          postDiv.appendChild(userImage);
          postDiv.appendChild(document.createElement('br'));
          postDiv.appendChild(timestamp);
          postDiv.appendChild(hr);

          posts.appendChild(postDiv);
        });
      });

      document.getElementById('close').addEventListener('click', function () {
        document.getElementById('about').style.display = 'none';
      });
      document.getElementById('me').addEventListener('click', function () {
        document.getElementById('about').style.display = 'flex';
      });
    </script>
  </body>
</html>
